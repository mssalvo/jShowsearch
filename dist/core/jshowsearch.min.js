/*!
 * jShowsearch v1.0.0 Â©
 * @author salvo mariniello - salvo.mariniello@gmail.com 
 * https://github.com/mssalvo/jShowsearch
 * MIT License
 * Copyright (c) 2020 Salvatore Mariniello
 * https://github.com/mssalvo/jShowsearch/blob/master/LICENSE
 * 
 * @see jShowsearch istance
 * @function jShowsearch.get('nameProcessUnique',{...})  
 * @example istance
 * 
 *           jShowsearch.get('myIstanceName', {
 *              form: '#myform', 
 *              btnUpdate:'#btnAggiorna01',
 *              btnRemove:'#btnRimuovi01',
 *              boxhome: '#home01',
 *              boxButton: '#button01',
 *              template: '#template01',
 *              templateButton:'<button {box} type="button" class="close" {click} aria-label="Close">Rimuovi Filtri <span aria-hidden="true">&times;</span></button>',
 *              esclude: ['id_element_1','id_element_2'],
 *              offEvent:false,
 *              click: function (id,ob,form) {
 *                  alert(id)
 *                    
 *                   form.submit();
 *              }
 *          })
 *          
 *  @Object Control
 *  @Parameter
 *  {
 *     form:            |ID ELEMENTO | OBJECT HTML | OBBLIGATORIO | indicare l'elemento <form> o il <div> contenete gli elementi
 *     btnUpdate:       |ID ELEMENTO | OBJECT HTML | FACOLTATIVO | indicare il button per aggiornare il contenuto visualizzato
 *     btnRemove:       |ID ELEMENTO | OBJECT HTML | FACOLTATIVO | indicare il button per rimuovere i filtri nel contenuto visualizzato
 *     boxhome:         |ID ELEMENTO | OBJECT HTML | OBBLIGATORIO | indicare l'elemento html dove includere gli elementi creati
 *     boxButton:       |ID ELEMENTO | OBJECT HTML | FACOLTATIVO | indicare l'elemento html dove includere in pulsante rimuovi tutti filtri, 
 *                                                                 se non indicato ed e' presente un templateButton, questo verra' incluso come ultimo elemento nel boxhome.
 *     template:        |STRING HTML | ID ELEMENTO | OBJECT HTML | OBBLIGATORIO | indicare l'elemento html o la stringa che descrive la struttura html del template
 *     templateButton:  |STRING HTML | ID ELEMENTO | OBJECT HTML | FACOLTATIVO  | indicare l'elemento html o la stringa che descrive la struttura html del button rimuvi tutti
 *     esclude:         |STRING    | ARRAY  | FACOLTATIVO | esclude dalla lista degli elementi gli elementi indicati dall'id, 
 *                                                          gli elementi esclusi non verranno processati
 *     offEvent:        |BOOLEAN TRUE/FALSE | FACOLTATIVO | (false)abilita / (true)disabilita gli eventi sui campi del form                                            
 *     click:           |FUNCTION | FACOLTATIVO | Esegue la funzione su ogni elemento con marcatore {click} 
 *                                                alla funzione nel costruttore viene iniettato l'id dell'elemento, l'elemeto, ed il form  
 *
 *  }
 *  
 *  
 *  @example Dichiarazione template
 *  @Importante il template indicato sia di tipo html o stringa deve contenere
 *              i seguenti marcatori {box} , {val} , {click}
 *     {box}   > va inserito sull'elemento principale della struttura html
 *     {val}   > va inserito dove deve comparire it testo descrittivo
 *     {click} > va inserito sull'elemento che deve eseguire l'azione
 *     
 *  	<template id="template01">
 *	<div {box} class="col alert alert-primary alert-dismissible fade show" role="alert">
 *		<strong> {val} </strong>
 *	<button type="button" class="close"  {click} aria-label="Close">
 *	  <span aria-hidden="true">&times;</span>
 *	</button>
 *	</div>   
 *	</template>
 *  
 *  
 *  @example Dichiarazione templateButton
 *  @Importante il templateButton indicato sia di tipo html o stringa deve contenere   
 *              i seguenti marcatori {box} , {val} , {click}
 *     {box}   > va inserito sull'elemento principale della struttura html
 *     {val}   > va inserito dove deve comparire it testo descrittivo
 *     {click} > va inserito sull'elemento che deve eseguire l'azione              
 *    <button {box} type="button" class="close" {click} aria-label="Close">Rimuovi Filtri <span aria-hidden="true">&times;</span></button>
 *    
 *  
 * */
(function(){if(typeof window.console==="undefined"||typeof window.console.warn==="undefined"||typeof window.console.error==="undefined"){window.console={log:function(){},warn:function(){},error:function(){}}}if(!("forEach" in Array.prototype)){Array.prototype.forEach=function(c,b){for(var a=0,d=this.length;a<d;a++){if(a in this){c.call(b,this[a],a,this)}}}}if(!("trim" in String.prototype)){String.prototype.trim=function(){var a=this;return a.replace(/^\s+|\s+$/gm,"")}}});function jShowsearch(b,a){this.inputs=[];this.name=b;this.boxform=undefined;this.tagform=undefined;this.btnUpdate=undefined;this.btnRemove=undefined;this.boxhome=undefined;this.boxButton=undefined;this.template=undefined;this.templateButton=undefined;this.after=function(){};this.esclude=undefined;this.isdelete=false;this.offEvent=false;this.elements={};this.init(a||{})}jShowsearch.istance={};jShowsearch.onclick=function(a,b){jShowsearch.istance[a].clearBox(b).after(b,jShowsearch.istance[a].elements[b].ob,jShowsearch.istance[a].tagform)};jShowsearch.removeAll=function(a){jShowsearch.istance[a].clearAllBox().after("removeAll",jShowsearch.istance[a].elements,jShowsearch.istance[a].tagform)};jShowsearch.prototype.clearAllBox=function(){var a=this;for(var b in a.elements){var d=a.elements[b].ob;if(d&&d.type){var c=d.type.toUpperCase();switch(c){case"TEXT":case"TEXTAREA":case"PASSWORD":case"EMAIL":case"SEARCH":case"NUMBER":case"TIME":case"DATE":case"DATETIME":case"DATETIME-LOCAL":case"MONTH":case"URL":d.value="";break;case"CHECKBOX":case"RADIO":d.checked=false;break;case"SELECT":case"SELECT-ONE":d.value="";default:break}}}if(typeof(a.boxhome)!=="undefined"&&typeof a.boxhome.querySelectorAll==="function"){Array.prototype.forEach.call(a.boxhome.querySelectorAll("[jShowsearch]"),function(f,e){f.parentNode.removeChild(f)})}if(null!==a.boxButton&&typeof a.boxButton!=="undefined"){a.boxButton.innerHTML=""}return a};jShowsearch.prototype.clearBox=function(e){var a=this;for(var b in a.elements){if(e===b){var d=a.elements[b].ob;if(d&&d.type){var c=d.type.toUpperCase();switch(c){case"TEXT":case"TEXTAREA":case"PASSWORD":case"EMAIL":case"SEARCH":case"NUMBER":case"TIME":case"DATE":case"DATETIME":case"DATETIME-LOCAL":case"MONTH":case"URL":d.value="";break;case"CHECKBOX":case"RADIO":d.checked=false;break;case"SELECT":case"SELECT-ONE":d.value="";default:break}}}}if(typeof(a.boxhome)!=="undefined"&&typeof a.boxhome.querySelectorAll==="function"){Array.prototype.forEach.call(a.boxhome.querySelectorAll("[jShowsearch]"),function(g,f){if(g.getAttribute("jShowsearch")===e){g.parentNode.removeChild(g)}})}return a};jShowsearch.prototype.add=function(b){var a=this;if(typeof b==="string"&&b!=="undefined"){a.inputs.push(document.getElementById(b)||document.querySelector(b))}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="undefined"){a.inputs.push(b)}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="string"){a.inputs.push(b.get(0))}else{window.console.warn("jShowsearch add:: impossibile addizionare l'elemento[ "+b+" ]")}}}return a};jShowsearch.prototype.setTemplate=function(c){var b=this;var a=/^<(\w*)\s*\/?(?:.* <\/\1>|)/.test(c);if(typeof c==="string"&&a){b.template=c}else{if(typeof c==="string"&&c!=="undefined"&&!a){b.template=document.getElementById(c)?document.getElementById(c).innerHTML:document.querySelector(c)?document.querySelector(c).innerHTML:c}else{if(null!==c&&typeof c==="object"&&typeof c.jquery==="undefined"){b.template=c.innerHTML}else{if(null!==c&&typeof c==="object"&&typeof c.jquery==="string"){b.template=c.get(0).innerHTML}else{window.console.warn("jShowsearch setTemplate:: impossibile settare l'elemento template[ "+c+" ]")}}}}return b};jShowsearch.prototype.setTemplateButton=function(c){var b=this;var a=/^<(\w*)\s*\/?(?:.* <\/\1>|)/.test(c);if(typeof c==="string"&&a){b.templateButton=c}else{if(typeof c==="string"&&c!=="undefined"&&!a){b.templateButton=document.getElementById(c)?document.getElementById(c).innerHTML:document.querySelector(c)?document.querySelector(c).innerHTML:c}else{if(null!==c&&typeof c==="object"&&typeof c.jquery==="undefined"){b.templateButton=c.innerHTML}else{if(null!==c&&typeof c==="object"&&typeof c.jquery==="string"){b.templateButton=c.get(0).innerHTML}else{window.console.warn("jShowsearch setTemplateButton:: impossibile settare l'elemento templateButton[ "+c+" ]")}}}}return b};jShowsearch.prototype.setBoxHome=function(b){var a=this;if(typeof b==="string"&&b!=="undefined"&&!/^<(\w*)\s*\/?(?:.* <\/\1>|)/.test(b)){a.boxhome=document.getElementById(b)||document.querySelector(b)}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="undefined"){a.boxhome=b}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="string"){a.boxhome=b.get(0)}else{window.console.warn("jShowsearch setBoxHome:: impossibile settare l'elemento boxhome[ "+b+" ]")}}}return a};jShowsearch.prototype.setBoxButton=function(b){var a=this;if(typeof b==="string"&&b!=="undefined"&&!/^<(\w*)\s*\/?(?:.* <\/\1>|)/.test(b)){a.boxButton=document.getElementById(b)||document.querySelector(b)}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="undefined"){a.boxButton=b}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="string"){a.boxButton=b.get(0)}else{window.console.warn("jShowsearch setBoxButton:: impossibile settare l'elemento boxButton[ "+b+" ]")}}}return a};jShowsearch.prototype.setBtnUpdate=function(b){var a=this;if(typeof b==="string"&&b!=="undefined"&&!/^<(\w*)\s*\/?(?:.* <\/\1>|)/.test(b)){a.btnUpdate=document.getElementById(b)||document.querySelector(b)}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="undefined"){a.btnUpdate=b}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="string"){a.btnUpdate=b.get(0)}else{window.console.warn("jShowsearch setBtnUpdate:: impossibile settare l'elemento btnUpdate[ "+b+" ]")}}}return a};jShowsearch.prototype.setBtnRemove=function(b){var a=this;if(typeof b==="string"&&b!=="undefined"&&!/^<(\w*)\s*\/?(?:.* <\/\1>|)/.test(b)){a.btnRemove=document.getElementById(b)||document.querySelector(b)}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="undefined"){a.btnRemove=b}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="string"){a.btnRemove=b.get(0)}else{window.console.warn("jShowsearch setBtnRemove:: impossibile settare l'elemento btnRemove[ "+b+" ]")}}}return a};jShowsearch.prototype.form=function(b){var a=this;if(typeof b==="string"&&b!=="undefined"&&!/^<(\w*)\s*\/?(?:.* <\/\1>|)/.test(b)){a.boxform=document.getElementById(b)||document.querySelector(b)}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="undefined"){a.boxform=b}else{if(null!==b&&typeof b==="object"&&typeof b.jquery==="string"){a.boxform=b.get(0)}else{window.console.warn("jShowsearch form:: impossibile settare l'elemento form[ "+b+" ]")}}}return a};jShowsearch.prototype.init=function(b){var a=this;if(b&&b.form){a.form(b.form)}if(b&&b.boxhome){a.setBoxHome(b.boxhome)}if(b&&b.boxButton){a.setBoxButton(b.boxButton)}if(b&&b.btnUpdate){a.setBtnUpdate(b.btnUpdate)}if(b&&b.btnRemove){a.setBtnRemove(b.btnRemove)}if(b&&b.template){a.setTemplate(b.template)}if(b&&b.templateButton){a.setTemplateButton(b.templateButton)}if(b&&typeof b.esclude==="string"){a.esclude=(b.esclude).split(",")}if(b&&typeof b.esclude==="object"){a.esclude=b.esclude}if(b&&typeof b.click==="function"){a.after=b.click}return a.searchForm().search(true).includeEvent()};jShowsearch.prototype.searchForm=function(){var c=this;if(null!==c.boxform&&typeof c.boxform!=="undefined"&&c.boxform.tagName==="FORM"){c.tagform=c.boxform}else{if(null!==c.boxform&&typeof c.boxform!=="undefined"&&c.boxform.tagName!=="FORM"){var a=c.boxform.querySelectorAll("*")||c.boxform.getElementsByTagName("*");for(var b in a){switch(a[b].tagName){case"FORM":c.tagform=a[b];break}}}else{window.console.error("jShowsearch searchForm:: l'elemento tagform risulta [ undefined ]")}}return c};jShowsearch.prototype.setValue=function(b){if(b&&b.type){var a=b.type.toUpperCase();switch(a){case"TEXT":case"TEXTAREA":case"PASSWORD":case"EMAIL":case"SEARCH":case"NUMBER":case"TIME":case"DATE":case"DATETIME":case"DATETIME-LOCAL":case"MONTH":case"URL":return b.value||"";case"CHECKBOX":case"RADIO":if(b.parentElement.htmlFor&&b.parentElement.htmlFor===b.id||b.parentElement.htmlFor===b.name){return b.checked?b.parentElement.innerText:""}else{return b.checked?b.value:""}case"SELECT":case"SELECT-ONE":return b.options[b.selectedIndex].value?b.options[b.selectedIndex].text:"";default:return""}}return"undefined"};jShowsearch.prototype.search=function(c){var e=this;if(null!==e.boxform&&typeof e.boxform!=="undefined"){var a=e.boxform.elements||e.boxform.querySelectorAll("*")||e.boxform.getElementsByTagName("*");for(var d in a){switch(a[d].tagName){case"INPUT":case"TEXTAREA":case"SELECT":if(a[d].id){e.elements[a[d].id]={val:e.setValue(a[d]),ob:a[d]};if(c){e.add(a[d])}}break;case"DIV":case"SPAN":case"P":case"PRE":case"CITE":case"CODE":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TD":if(a[d].contentEditable&&a[d].isContentEditable){e.elements[a[d].id]={val:a[d].innerHTML,ob:a[d]};if(c){e.add(a[d])}}break}}return e.write()}else{window.console.error("jShowsearch search:: l'elemento boxform risulta [ undefined ]");return e}};jShowsearch.prototype.includeEvent=function(){var b=this;if(null!==b.btnUpdate&&typeof b.btnUpdate!=="undefined"){b.btnUpdate.addEventListener("click",function(){b.search(0)},false)}if(null!==b.btnRemove&&typeof b.btnRemove!=="undefined"){b.btnRemove.addEventListener("click",function(){b.clearAllBox()},false)}if(!this.offEvent&&b.inputs.length){for(var a in b.inputs){b.inputs[a].addEventListener("change",function(){b.search(0)},false)}}return b};jShowsearch.prototype.clear=function(){var b=this;if(typeof b.esclude!=="undefined"){for(var c in b.elements){for(var a in b.esclude){if(b.esclude[a]===c){delete b.elements[c]}}}}};jShowsearch.prototype.write=function(){var b=this;if(null!==b.template&&typeof b.template!=="undefined"){b.clear();var d=b.template;var a=[];for(var c in b.elements){if(b.elements[c].val.trim()!==""){a.push(String(d).replace("{box}","jShowsearch='"+c+"'").replace("{val}",b.elements[c].val).replace("{click}","onclick=jShowsearch.onclick('"+b.name+"','"+c+"')"))}}if(a.length&&null!==b.templateButton&&typeof b.templateButton!=="undefined"){var e=String(b.templateButton).replace("{box}","jShowsearch='removeAll'").replace("{val}","Rimuovi Filtri").replace("{click}","onclick=jShowsearch.removeAll('"+b.name+"')");if(null!==b.boxButton&&typeof b.boxButton!=="undefined"){b.boxButton.innerHTML=e}else{if(a.length>1){a.push(e)}}}b.boxhome.innerHTML=a.join("")}else{window.console.error("jShowsearch write:: l'elemento template risulta [ undefined ]")}return b};jShowsearch.get=function(b,a){var d,c;if(typeof(arguments[0])==="object"){c=arguments[0]}else{if(typeof(arguments[0])==="string"){d=arguments[0]}}if(typeof(arguments[1])==="object"){c=arguments[1]}else{if(typeof(arguments[1])==="string"){d=arguments[1]}}if(typeof(d)==="undefined"){d=new Date().getTime()}if(typeof(jShowsearch.istance[d])==="undefined"){jShowsearch.istance[d]=new jShowsearch(d,c)}return jShowsearch.istance[d]};
